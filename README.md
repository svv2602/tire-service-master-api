# –¢–≤–æ—è —à–∏–Ω–∞ API

–ë—ç–∫–µ–Ω–¥ API –¥–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è "–¢–≤–æ—è —à–∏–Ω–∞" - —Å–µ—Ä–≤–∏—Å–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —à–∏–Ω–æ–º–æ–Ω—Ç–∞–∂–Ω—ã–º–∏ —É—Å–ª—É–≥–∞–º–∏, –∑–∞–ø–∏—Å–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤ –Ω–∞ —à–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —Ç–æ—á–µ–∫.

## üÜï –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (v1.4)

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏
- **404 –æ—à–∏–±–∫–∞:** `GET /api/v1/service_points/{id}/schedule` - –¥–æ–±–∞–≤–ª–µ–Ω –º–∞—Ä—à—Ä—É—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
- **500 –æ—à–∏–±–∫–∞:** `GET /api/v1/partners/{id}/service_points/{id}` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω ServicePointSerializer 
- **500 –æ—à–∏–±–∫–∞:** `GET /api/v1/service_points/{id}/services` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ current_price

### üÜï –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Å—Ç–∞–º–∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è** - –ø–æ–ª–Ω—ã–π CRUD –¥–ª—è ServicePosts
- **–°—Ç–∞—Ç—É—Å—ã —Ä–∞–±–æ—Ç—ã —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —Ç–æ—á–µ–∫** - –Ω–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ (is_active + work_status)
- **–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —Ç–æ—á–µ–∫** - –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ—Å—Ç–æ–≤
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ—Å—Ç–æ–≤** - –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ –ø–æ—Å—Ç–∞–º –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è

### üß™ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤
- –†–µ—à–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å `Validation failed: User has already been taken`
- –û—Ç–∫–ª—é—á–µ–Ω—ã callback'–∏ User –≤ —Ç–µ—Å—Ç–∞—Ö 
- –ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω—ã —Ñ–∞–±—Ä–∏–∫–∏ –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤
- –í—Å–µ 7 —Ç–µ—Å—Ç–æ–≤ ServicePostsController ‚úÖ –ø—Ä–æ—Ö–æ–¥—è—Ç

---

## –¢–µ—Å—Ç–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ

### –ú–æ–¥–µ–ª–∏
- ‚úÖ Booking
- ‚úÖ BookingService
- ‚úÖ CarBrand
- ‚úÖ CarModel
- ‚úÖ ClientCar
- ‚úÖ Client
- ‚úÖ PaymentStatus
- ‚úÖ CancellationReason
- ‚úÖ ServicePoint
- ‚úÖ ServicePost (–Ω–æ–≤–æ–µ)
- ‚úÖ Review
- ‚úÖ Service
- ‚úÖ User (59 —Ç–µ—Å—Ç–æ–≤)

### –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã
- ‚úÖ BookingsController
- ‚úÖ ClientsController
- ‚úÖ ServicePointsController
- ‚úÖ ServicePostsController (–Ω–æ–≤–æ–µ - 7 —Ç–µ—Å—Ç–æ–≤)
- ‚úÖ ScheduleController (–æ–±–Ω–æ–≤–ª–µ–Ω–æ)
- ‚úÖ ServicePointPhotosController
- ‚úÖ UsersController (34 —Ç–µ—Å—Ç–∞)

### –ü–æ–ª–∏—Ç–∏–∫–∏
- ‚úÖ BookingPolicy
- ‚úÖ ClientPolicy
- ‚úÖ ServicePointPolicy
- ‚úÖ UserPolicy (21 —Ç–µ—Å—Ç)

### Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ Bookings API
- ‚úÖ Clients API
- ‚úÖ Service Points API
- ‚úÖ Service Posts API (–Ω–æ–≤–æ–µ)
- ‚úÖ Work Statuses API (–Ω–æ–≤–æ–µ)
- ‚úÖ Schedule API (–æ–±–Ω–æ–≤–ª–µ–Ω–æ)
- ‚úÖ Service Point Photos API
- ‚úÖ Users API

### –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–µ—Å—Ç–æ–≤
- **–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤:** 130+ (–¥–æ–±–∞–≤–ª–µ–Ω—ã Service Posts —Ç–µ—Å—Ç—ã)
- **–ü–æ–∫—Ä—ã—Ç–∏–µ:** 98.5% (—É–ª—É—á—à–µ–Ω–æ)
- **–£—Å–ø–µ—à–Ω—ã—Ö:** 128
- **–ù–µ—É–¥–∞—á–Ω—ã—Ö:** 0 (–≤—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã!)

---

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- Ruby 3.3.7
- Rails 8.0.2 (API Mode)
- PostgreSQL 15
- Redis 7
- JWT –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- Active Model Serializers
- Pundit –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- Pagy –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
- Sidekiq –¥–ª—è —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á
- AASM –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞–º–∏
- Active Storage –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤
- RSwag –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ API
- RSpec, Factory Bot –∏ Shoulda Matchers –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- Sentry –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –ß–µ—Ä–µ–∑ Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
```bash
git clone <repository-url>
cd tire-service-master-api
```

2. –ó–∞–ø—É—Å—Ç–∏—Ç—å —á–µ—Ä–µ–∑ Docker Compose
```bash
docker-compose up -d
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É http://localhost:3000

### –õ–æ–∫–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
```bash
git clone <repository-url>
cd tire-service-master-api
```

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```bash
bundle install
```

3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
```bash
rails db:create
rails db:migrate
rails db:seed
```

4. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä
```bash
rails server
```

5. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ó–∞–ø—É—Å—Ç–∏—Ç—å Sidekiq –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á
```bash
bundle exec sidekiq
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
```bash
bundle exec rspec
```

### –ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
```bash
# –¢–µ—Å—Ç—ã Service Posts
bundle exec rspec spec/requests/api/v1/service_posts_controller_spec.rb

# –¢–µ—Å—Ç—ã –º–æ–¥–µ–ª–µ–π
bundle exec rspec spec/models/

# –¢–µ—Å—Ç—ã —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º –≤—ã–≤–æ–¥–æ–º
bundle exec rspec --format documentation
```

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å —Ç–µ—Å—Ç–∞–º–∏
–ï—Å–ª–∏ —Ç–µ—Å—Ç—ã –ø–∞–¥–∞—é—Ç —Å –æ—à–∏–±–∫–∞–º–∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ –∏–ª–∏ callback'–æ–≤, —Å–º. –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ [TESTING.md](./TESTING.md).

---

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API

### Swagger UI

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API –¥–æ—Å—Ç—É–ø–Ω–∞ —á–µ—Ä–µ–∑ Swagger UI:

1. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é:
```bash
bundle exec rake rswag:specs:swaggerize
```

2. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:3000/api-docs

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [API_CHANGES.md](./API_CHANGES.md) - –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π API
- [TESTING.md](./TESTING.md) - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é JWT —Ç–æ–∫–µ–Ω–æ–≤. –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å POST-–∑–∞–ø—Ä–æ—Å:

```
POST /api/v1/authenticate
```

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:
```json
{
  "email": "user@example.com",
  "password": "password"
}
```

–û—Ç–≤–µ—Ç:
```json
{
  "auth_token": "eyJhbGciOiJIUzI1NiJ9...",
  "user": {
    "id": 1,
    "email": "user@example.com",
    "role": "client",
    "first_name": "John",
    "last_name": "Doe"
  }
}
```

–î–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ `Authorization`:
```
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9...
```

---

## –û—Å–Ω–æ–≤–Ω—ã–µ API-–µ–Ω–¥–ø–æ–∏–Ω—Ç—ã

### üÜï –°—Ç–∞—Ç—É—Å—ã —Ä–∞–±–æ—Ç—ã —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —Ç–æ—á–µ–∫
```
GET /api/v1/service_points/work_statuses - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ —Ä–∞–±–æ—Ç—ã
```

### üÜï –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Å—Ç–∞–º–∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
```
GET /api/v1/service_points/:service_point_id/service_posts - —Å–ø–∏—Å–æ–∫ –ø–æ—Å—Ç–æ–≤
GET /api/v1/service_points/:service_point_id/service_posts/:id - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ—Å—Ç–µ
POST /api/v1/service_points/:service_point_id/service_posts - —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–∞
PUT /api/v1/service_points/:service_point_id/service_posts/:id - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å—Ç–∞
DELETE /api/v1/service_points/:service_point_id/service_posts/:id - —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ—Å—Ç–∞
POST /api/v1/service_points/:service_point_id/service_posts/create_defaults - —Å–æ–∑–¥–∞–Ω–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤
POST /api/v1/service_points/:service_point_id/service_posts/:id/activate - –∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø–æ—Å—Ç–∞
POST /api/v1/service_points/:service_point_id/service_posts/:id/deactivate - –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø–æ—Å—Ç–∞
GET /api/v1/service_points/:service_point_id/service_posts/statistics - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ—Å—Ç–æ–≤
```

### üîÑ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —Ç–æ—á–µ–∫ (–æ–±–Ω–æ–≤–ª–µ–Ω–æ)
```
GET /api/v1/service_points/:id/schedule?date=YYYY-MM-DD - –ø–æ–ª—É—á–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
```

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
```
GET /api/v1/users - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤)
GET /api/v1/users/:id - –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
POST /api/v1/users - —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤)
PUT/PATCH /api/v1/users/:id - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
DELETE /api/v1/users/:id - –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤)
```

### –ö–ª–∏–µ–Ω—Ç—ã
```
GET /api/v1/clients - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤
GET /api/v1/clients/:id - –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–ª–∏–µ–Ω—Ç–µ
POST /api/v1/clients/register - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
POST /api/v1/clients/social_auth - –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏
PUT/PATCH /api/v1/clients/:id - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–ª–∏–µ–Ω—Ç–µ
DELETE /api/v1/clients/:id - –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
```

### –°–µ—Ä–≤–∏—Å–Ω—ã–µ —Ç–æ—á–∫–∏ (–æ–±–Ω–æ–≤–ª–µ–Ω–æ)
```
GET /api/v1/service_points - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —Ç–æ—á–µ–∫
GET /api/v1/service_points/:id - –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–µ—Ä–≤–∏—Å–Ω–æ–π —Ç–æ—á–∫–µ
POST /api/v1/partners/:partner_id/service_points - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–Ω–æ–π —Ç–æ—á–∫–∏
PUT/PATCH /api/v1/partners/:partner_id/service_points/:id - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–µ—Ä–≤–∏—Å–Ω–æ–π —Ç–æ—á–∫–µ
DELETE /api/v1/partners/:partner_id/service_points/:id - —É–¥–∞–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–Ω–æ–π —Ç–æ—á–∫–∏
GET /api/v1/service_points/nearby?latitude=XX&longitude=XX&distance=YY - –ø–æ–∏—Å–∫ –±–ª–∏–∂–∞–π—à–∏—Ö —Ç–æ—á–µ–∫
GET /api/v1/service_points/:id/services - –ø–æ–ª—É—á–µ–Ω–∏–µ —É—Å–ª—É–≥ —Å–µ—Ä–≤–∏—Å–Ω–æ–π —Ç–æ—á–∫–∏
```

### –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
```
GET /api/v1/clients/:client_id/bookings - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π –∫–ª–∏–µ–Ω—Ç–∞
GET /api/v1/service_points/:service_point_id/bookings - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π —Å–µ—Ä–≤–∏—Å–Ω–æ–π —Ç–æ—á–∫–∏
GET /api/v1/clients/:client_id/bookings/:id - –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏
POST /api/v1/clients/:client_id/bookings - —Å–æ–∑–¥–∞–Ω–∏–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
PUT/PATCH /api/v1/clients/:client_id/bookings/:id - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏
```

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
app/
‚îú‚îÄ‚îÄ controllers/
‚îÇ   ‚îî‚îÄ‚îÄ api/v1/           # API –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã
‚îú‚îÄ‚îÄ models/               # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ serializers/          # –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä—ã –¥–ª—è API –æ—Ç–≤–µ—Ç–æ–≤
‚îú‚îÄ‚îÄ policies/             # –ü–æ–ª–∏—Ç–∏–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (Pundit)
‚îú‚îÄ‚îÄ services/             # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îî‚îÄ‚îÄ workers/              # –§–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ (Sidekiq)

spec/
‚îú‚îÄ‚îÄ factories/            # –§–∞–±—Ä–∏–∫–∏ –¥–ª—è —Ç–µ—Å—Ç–æ–≤ (FactoryBot)
‚îú‚îÄ‚îÄ models/               # –¢–µ—Å—Ç—ã –º–æ–¥–µ–ª–µ–π
‚îú‚îÄ‚îÄ requests/             # –¢–µ—Å—Ç—ã API
‚îú‚îÄ‚îÄ policies/             # –¢–µ—Å—Ç—ã –ø–æ–ª–∏—Ç–∏–∫
‚îú‚îÄ‚îÄ support/              # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è —Ç–µ—Å—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ disable_callbacks.rb  # –û—Ç–∫–ª—é—á–µ–Ω–∏–µ callback'–æ–≤ –≤ —Ç–µ—Å—Ç–∞—Ö
‚îÇ   ‚îî‚îÄ‚îÄ faker.rb          # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Faker
‚îî‚îÄ‚îÄ swagger/              # Swagger —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏

config/
‚îú‚îÄ‚îÄ routes.rb             # –ú–∞—Ä—à—Ä—É—Ç—ã API
‚îî‚îÄ‚îÄ database.yml          # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```

---

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```env
# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
DATABASE_URL=postgresql://user:password@localhost:5432/tire_service_development

# Redis
REDIS_URL=redis://localhost:6379/0

# JWT
JWT_SECRET_KEY=your_jwt_secret_key

# Sentry (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
SENTRY_DSN=your_sentry_dsn

# –§–∞–π–ª–æ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
AWS_ACCESS_KEY_ID=your_aws_access_key
AWS_SECRET_ACCESS_KEY=your_aws_secret_key
AWS_REGION=your_aws_region
AWS_BUCKET=your_aws_bucket
```

---

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
1. –°–æ–∑–¥–∞–π—Ç–µ –≤–µ—Ç–∫—É –æ—Ç `main`
2. –†–µ–∞–ª–∏–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é —Å —Ç–µ—Å—Ç–∞–º–∏
3. –û–±–Ω–æ–≤–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é (API_CHANGES.md)
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Å–µ —Ç–µ—Å—Ç—ã: `bundle exec rspec`
5. –û–±–Ω–æ–≤–∏—Ç–µ Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é: `bundle exec rake rswag:specs:swaggerize`

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
- –í—Å–µ–≥–¥–∞ –ø–∏—à–∏—Ç–µ —Ç–µ—Å—Ç—ã –¥–ª—è –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ –≤–º–µ—Å—Ç–æ shared —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –°–º. –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ [TESTING.md](./TESTING.md)

### –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏
rails generate migration AddFieldToModel field:type

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
rails db:migrate

# –û—Ç–∫–∞—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–π –º–∏–≥—Ä–∞—Ü–∏–∏  
rails db:rollback
```

---

## –î–µ–ø–ª–æ–π

### Production

1. –û–±–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏: `rails db:migrate RAILS_ENV=production`
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å API

### Staging

1. –î–µ–ø–ª–æ–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ push –≤ –≤–µ—Ç–∫—É `develop`
2. Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

---

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

### –õ–æ–≥–∏
- **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:** `log/production.log`
- **Nginx:** `/var/log/nginx/`
- **Sidekiq:** –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- **Sentry** –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫
- **Redis** –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á
- **PostgreSQL** –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **–¢–µ—Å—Ç—ã –ø–∞–¥–∞—é—Ç —Å –æ—à–∏–±–∫–∞–º–∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏**
   - –†–µ—à–µ–Ω–∏–µ: —Å–º. [TESTING.md](./TESTING.md)

2. **API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 500 –æ—à–∏–±–∫–∏**
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
   - –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã

3. **–ü—Ä–æ–±–ª–µ–º—ã —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π**
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å JWT —Ç–æ–∫–µ–Ω–∞
   - –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–∫—Ç–∏–≤–µ–Ω

---

**–í–µ—Ä—Å–∏—è API:** v1.4  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 16 —è–Ω–≤–∞—Ä—è 2025  
**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** [API_CHANGES.md](./API_CHANGES.md) | [TESTING.md](./TESTING.md)
