# Создание тестовых статей

puts "Creating articles..."

# Найдем админа или первого пользователя как автора
admin_user = User.find_by(role: 'admin') || User.first

unless admin_user
  puts "No admin user found. Creating admin user for articles..."
  admin_user = User.create!(
    name: 'Автор статей',
    email: 'author@articles.com',
    password: 'password123',
    role: 'admin',
    confirmed_at: Time.current
  )
end

# Очистка существующих тестовых статей
Article.where(author: admin_user).destroy_all

articles_data = [
  {
    title: 'Как выбрать зимние шины: полное руководство',
    content: %{
      <h2>Введение</h2>
      <p>Выбор зимних шин - это критически важное решение для безопасности вождения в холодное время года. Правильно подобранные шины обеспечивают лучшее сцепление с дорогой, сокращают тормозной путь и повышают устойчивость автомобиля.</p>
      
      <h2>Основные критерии выбора</h2>
      <h3>1. Размер шин</h3>
      <p>Размер шин указан на боковине и состоит из трех основных параметров: ширина протектора, высота профиля и диаметр диска. Например, 205/55 R16 означает:</p>
      <ul>
        <li>205 - ширина протектора в миллиметрах</li>
        <li>55 - высота профиля в процентах от ширины</li>
        <li>R16 - радиальная конструкция, диаметр диска 16 дюймов</li>
      </ul>
      
      <h3>2. Тип протектора</h3>
      <p>Существует несколько типов зимних шин:</p>
      <ul>
        <li><strong>Шипованные шины</strong> - обеспечивают отличное сцепление на льду</li>
        <li><strong>Нешипованные (фрикционные)</strong> - универсальны для различных условий</li>
        <li><strong>Скандинавский тип</strong> - для суровых зимних условий</li>
        <li><strong>Европейский тип</strong> - для мягких зим</li>
      </ul>
      
      <h2>Индексы нагрузки и скорости</h2>
      <p>Не забудьте проверить индексы нагрузки и скорости, которые должны соответствовать требованиям вашего автомобиля.</p>
      
      <h2>Заключение</h2>
      <p>Правильный выбор зимних шин - это инвестиция в вашу безопасность. Не экономьте на качестве и обращайтесь к профессионалам за консультацией.</p>
    },
    excerpt: 'Подробное руководство по выбору зимних шин: размеры, типы протектора, индексы нагрузки и скорости. Все что нужно знать для безопасной езды зимой.',
    category: 'selection',
    status: 'published',
    featured: true,
    meta_title: 'Как выбрать зимние шины - полное руководство 2024',
    meta_description: 'Экспертное руководство по выбору зимних шин. Размеры, типы протектора, шипованные vs фрикционные. Советы профессионалов.',
    allow_comments: true,
    tags: ['зимние шины', 'выбор шин', 'безопасность', 'шипы', 'фрикционные']
  },
  {
    title: 'Сезонная замена шин: когда и как правильно менять',
    content: %{
      <h2>Когда менять шины на зимние</h2>
      <p>Основное правило - переходить на зимние шины когда среднесуточная температура опускается ниже +7°C и остается на этом уровне несколько дней подряд.</p>
      
      <h2>Признаки необходимости замены</h2>
      <ul>
        <li>Температура воздуха стабильно ниже +7°C</li>
        <li>Появление первых заморозков</li>
        <li>Ухудшение сцепления летних шин</li>
        <li>Увеличение тормозного пути</li>
      </ul>
      
      <h2>Процесс замены</h2>
      <h3>Подготовка</h3>
      <p>Перед заменой шин необходимо:</p>
      <ol>
        <li>Проверить состояние зимних шин</li>
        <li>Убедиться в правильности давления</li>
        <li>Проверить глубину протектора</li>
        <li>Осмотреть диски на предмет повреждений</li>
      </ol>
      
      <h3>Порядок действий</h3>
      <p>Замену лучше проводить в специализированном шиномонтаже, где есть необходимое оборудование и опыт.</p>
      
      <h2>Хранение снятых шин</h2>
      <p>Правильное хранение продлевает срок службы шин:</p>
      <ul>
        <li>Чистое, сухое помещение</li>
        <li>Температура от -30 до +35°C</li>
        <li>Защита от прямых солнечных лучей</li>
        <li>Вертикальное хранение или на специальных стеллажах</li>
      </ul>
    },
    excerpt: 'Узнайте когда и как правильно менять шины на зимние. Признаки необходимости замены, процесс смены и правила хранения.',
    category: 'seasonal',
    status: 'published',
    featured: false,
    meta_title: 'Сезонная замена шин - когда менять на зимние',
    meta_description: 'Руководство по сезонной замене шин. Когда переходить на зимние шины, процесс замены и правила хранения.',
    allow_comments: true,
    tags: ['замена шин', 'сезонные шины', 'шиномонтаж', 'хранение шин']
  },
  {
    title: 'Проверка давления в шинах: важность и методы',
    content: %{
      <h2>Почему важно контролировать давление</h2>
      <p>Правильное давление в шинах критично для:</p>
      <ul>
        <li>Безопасности движения</li>
        <li>Экономии топлива</li>
        <li>Равномерного износа протектора</li>
        <li>Комфорта вождения</li>
      </ul>
      
      <h2>Последствия неправильного давления</h2>
      
      <h3>Недостаточное давление</h3>
      <ul>
        <li>Повышенный расход топлива</li>
        <li>Быстрый износ краев протектора</li>
        <li>Ухудшение управляемости</li>
        <li>Риск повреждения шины</li>
      </ul>
      
      <h3>Избыточное давление</h3>
      <ul>
        <li>Жесткая езда</li>
        <li>Износ центральной части протектора</li>
        <li>Снижение сцепления с дорогой</li>
        <li>Повышенный риск прокола</li>
      </ul>
      
      <h2>Как правильно проверять давление</h2>
      <ol>
        <li>Проверяйте давление на холодных шинах</li>
        <li>Используйте качественный манометр</li>
        <li>Проверяйте все шины, включая запасную</li>
        <li>Сверяйтесь с рекомендациями производителя</li>
      </ol>
      
      <h2>Частота проверки</h2>
      <p>Рекомендуется проверять давление:</p>
      <ul>
        <li>Не реже одного раза в месяц</li>
        <li>Перед дальними поездками</li>
        <li>При резких изменениях температуры</li>
        <li>При подозрении на утечку воздуха</li>
      </ul>
    },
    excerpt: 'Важность регулярной проверки давления в шинах для безопасности и экономии. Методы проверки и рекомендации экспертов.',
    category: 'maintenance',
    status: 'published',
    featured: false,
    meta_title: 'Проверка давления в шинах - руководство автовладельца',
    meta_description: 'Как правильно проверять давление в шинах. Важность контроля, последствия неправильного давления, методы проверки.',
    allow_comments: true,
    tags: ['давление в шинах', 'обслуживание', 'безопасность', 'экономия топлива']
  },
  {
    title: 'Безопасность на дороге зимой: топ-10 правил',
    content: %{
      <h2>Основные правила зимнего вождения</h2>
      
      <h3>1. Подготовка автомобиля</h3>
      <p>Убедитесь что ваш автомобиль готов к зиме:</p>
      <ul>
        <li>Зимние шины установлены</li>
        <li>Аккумулятор в хорошем состоянии</li>
        <li>Антифриз соответствует климату</li>
        <li>Стеклоочистители работают исправно</li>
      </ul>
      
      <h3>2. Снижение скорости</h3>
      <p>Зимой дистанция торможения увеличивается в несколько раз. Снижайте скорость и увеличивайте дистанцию.</p>
      
      <h3>3. Плавность движений</h3>
      <p>Избегайте резких:</p>
      <ul>
        <li>Ускорений</li>
        <li>Торможений</li>
        <li>Поворотов руля</li>
        <li>Переключений передач</li>
      </ul>
      
      <h3>4. Контроль сцепления</h3>
      <p>Регулярно проверяйте сцепление шин с дорогой легким торможением или ускорением.</p>
      
      <h3>5. Видимость</h3>
      <p>Поддерживайте хорошую видимость:</p>
      <ul>
        <li>Очищайте все стекла от снега и льда</li>
        <li>Используйте фары даже днем</li>
        <li>Очищайте номерные знаки</li>
      </ul>
      
      <h3>6-10. Дополнительные советы</h3>
      <p>Изучите остальные важные правила безопасного зимнего вождения в нашем полном руководстве.</p>
    },
    excerpt: 'Топ-10 правил безопасного вождения зимой. Подготовка автомобиля, техника вождения и советы экспертов.',
    category: 'safety',
    status: 'draft',
    featured: false,
    meta_title: 'Безопасность на дороге зимой - 10 важных правил',
    meta_description: 'Правила безопасного вождения зимой. Подготовка автомобиля, техника вождения, контроль сцепления.',
    allow_comments: true,
    tags: ['безопасность', 'зимнее вождение', 'правила дорожного движения']
  },
  {
    title: 'Обзор лучших зимних шин 2024 года',
    content: %{
      <h2>Методология тестирования</h2>
      <p>Наши эксперты протестировали более 20 моделей зимних шин в различных условиях:</p>
      <ul>
        <li>Торможение на льду и снегу</li>
        <li>Разгон на скользкой поверхности</li>
        <li>Управляемость в поворотах</li>
        <li>Шумность и комфорт</li>
        <li>Износостойкость</li>
      </ul>
      
      <h2>Топ-5 шипованных шин</h2>
      
      <h3>1. Nokian Hakkapeliitta 10</h3>
      <p>Лидер в категории шипованных шин:</p>
      <ul>
        <li>Отличное сцепление на льду</li>
        <li>Низкий уровень шума</li>
        <li>Долговечность шипов</li>
      </ul>
      
      <h3>2. Continental IceContact 3</h3>
      <p>Немецкое качество и инновации:</p>
      <ul>
        <li>Сбалансированные характеристики</li>
        <li>Хорошая управляемость</li>
        <li>Эффективность на мокром асфальте</li>
      </ul>
      
      <h2>Топ-5 фрикционных шин</h2>
      
      <h3>1. Michelin X-Ice Xi3</h3>
      <p>Французское совершенство:</p>
      <ul>
        <li>Превосходное сцепление</li>
        <li>Низкий расход топлива</li>
        <li>Длительный срок службы</li>
      </ul>
      
      <h2>Рекомендации по выбору</h2>
      <p>При выборе учитывайте ваши условия эксплуатации, бюджет и предпочтения в управляемости.</p>
    },
    excerpt: 'Профессиональный обзор лучших зимних шин 2024 года. Тесты, рейтинги и рекомендации экспертов.',
    category: 'reviews',
    status: 'published',
    featured: true,
    meta_title: 'Лучшие зимние шины 2024 - тест и обзор экспертов',
    meta_description: 'Обзор и тест лучших зимних шин 2024 года. Шипованные и фрикционные шины, рейтинг и рекомендации.',
    allow_comments: true,
    tags: ['обзор шин', 'тест шин', 'рейтинг', 'зимние шины 2024']
  }
]

articles_data.each_with_index do |article_data, index|
  puts "Creating article #{index + 1}: #{article_data[:title]}"
  
  article = Article.create!(
    title: article_data[:title],
    content: article_data[:content],
    excerpt: article_data[:excerpt],
    category: article_data[:category],
    status: article_data[:status],
    featured: article_data[:featured],
    meta_title: article_data[:meta_title],
    meta_description: article_data[:meta_description],
    allow_comments: article_data[:allow_comments],
    tags: article_data[:tags],
    author: admin_user,
    views_count: rand(100..2000), # Случайное количество просмотров
    published_at: article_data[:status] == 'published' ? rand(30.days.ago..Time.current) : nil
  )
  
  puts "✅ Created article: #{article.title} (ID: #{article.id})"
end

puts "✅ Successfully created #{articles_data.length} test articles!"
puts "📊 Articles by category:"
Article.group(:category).count.each do |category, count|
  category_name = Article::CATEGORIES[category]&.dig(:name) || category
  puts "  - #{category_name}: #{count}"
end 