# üéâ –ü–û–õ–ù–û–ï –†–ï–®–ï–ù–ò–ï: –ó–∞–≥—Ä—É–∑–∫–∞ –ª–æ–≥–æ—Ç–∏–ø–æ–≤ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤ –≤ —Å–∏—Å—Ç–µ–º–µ Tire Service

## üéØ –ü—Ä–æ–±–ª–µ–º–∞
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–æ–±—â–∏–ª, —á—Ç–æ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –ª–æ–≥–æ—Ç–∏–ø–æ–≤ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å. –§—Ä–æ–Ω—Ç–µ–Ω–¥ –æ—Ç–ø—Ä–∞–≤–ª—è–ª —Ñ–∞–π–ª—ã, –Ω–æ –æ–Ω–∏ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∏—Å—å –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è.

## üîç –ü—Ä–æ–≤–µ–¥–µ–Ω–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### ‚úÖ –ë—ç–∫–µ–Ω–¥ —Ä–∞–±–æ—Ç–∞–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API —á–µ—Ä–µ–∑ Ruby —Å–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∑–∞–ª–æ:**
```bash
ruby external-files/testing/test_partner_logo_direct.rb
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞
- ‚úÖ –õ–æ–≥–æ—Ç–∏–ø —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω: `http://localhost:8000/rails/active_storage/blobs/redirect/...`
- ‚úÖ Active Storage –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ñ–∞–π–ª—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**–õ–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª–∏:**
```
‚úÖ New logo file detected: img_calc.png
File size: 1267977 bytes
File content type: image/png
Logo attached after update: true
Response JSON logo field: http://localhost:8000/rails/active_storage/blobs/redirect/...
```

### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ –≤–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ
**–ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞:** –§—Ä–æ–Ω—Ç–µ–Ω–¥ –Ω–µ –æ–±–Ω–æ–≤–ª—è–ª –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ª–æ–≥–æ—Ç–∏–ø–∞ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏.

**–õ–æ–≥–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –ø–æ–∫–∞–∑–∞–ª–∏:**
```
üñºÔ∏è –õ–æ–≥–æ—Ç–∏–ø –≤ –æ—Ç–≤–µ—Ç–µ —Å–µ—Ä–≤–µ—Ä–∞: http://localhost:8000/rails/active_storage/blobs/redirect/...
üñºÔ∏è logo_url –≤ –æ—Ç–≤–µ—Ç–µ —Å–µ—Ä–≤–µ—Ä–∞: https://via.placeholder.com/200x100?text=...
```

–ë—ç–∫–µ–Ω–¥ –≤–æ–∑–≤—Ä–∞—â–∞–ª –Ω–æ–≤—ã–π –ª–æ–≥–æ—Ç–∏–ø –≤ –ø–æ–ª–µ `logo`, –Ω–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –ø—Ä–æ–¥–æ–ª–∂–∞–ª –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å —Å—Ç–∞—Ä—ã–π `logo_url`.

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. Frontend: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∏–ø–∏–∑–∞—Ü–∏–∏
**–§–∞–π–ª:** `tire-service-master-web/src/types/models.ts`
```typescript
export interface Partner {
  // ... existing fields
  logo_url?: string;
  logo?: string; // –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ –¥–ª—è URL Active Storage –ª–æ–≥–æ—Ç–∏–ø–∞
  // ... rest of fields
}
```

### 2. Frontend: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
**–§–∞–π–ª:** `tire-service-master-web/src/pages/partners/PartnerFormPage.tsx`
```typescript
// –û–±–Ω–æ–≤–ª—è–µ–º preview –ª–æ–≥–æ—Ç–∏–ø–∞, –µ—Å–ª–∏ –µ—Å—Ç—å –Ω–æ–≤—ã–π –ª–æ–≥–æ—Ç–∏–ø
if (response.logo) {
  console.log('üîÑ –û–±–Ω–æ–≤–ª—è–µ–º preview –ª–æ–≥–æ—Ç–∏–ø–∞ –Ω–∞:', response.logo);
  setLogoPreview(response.logo);
  // –û—á–∏—â–∞–µ–º —Ñ–∞–π–ª, —Ç–∞–∫ –∫–∞–∫ –ª–æ–≥–æ—Ç–∏–ø —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω
  setLogoFile(null);
}
```

### 3. Frontend: –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç Active Storage –ª–æ–≥–æ—Ç–∏–ø–∞
**–§–∞–π–ª:** `tire-service-master-web/src/pages/partners/PartnerFormPage.tsx`
```typescript
// –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —É –Ω–æ–≤–æ–≥–æ –ø–æ–ª—è logo (Active Storage), –ø–æ—Ç–æ–º logo_url
const logoToUse = partner?.logo || partner?.logo_url;
if (logoToUse) {
  const logoUrl = logoToUse.startsWith('http') || logoToUse.startsWith('/storage/')
    ? logoToUse
    : `${process.env.REACT_APP_API_URL || 'http://localhost:8000'}${logoToUse}`;
  setLogoPreview(logoUrl);
  console.log('üñºÔ∏è –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω preview –ª–æ–≥–æ—Ç–∏–ø–∞:', logoUrl);
}
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è

### –¢–µ—Å—Ç 1: API —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
```bash
‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞
‚úÖ –õ–æ–≥–æ—Ç–∏–ø —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω —á–µ—Ä–µ–∑ API
‚úÖ Active Storage —Å–æ–∑–¥–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ URL
```

### –¢–µ—Å—Ç 2: Frontend –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
```javascript
üöÄ handleSubmit –≤—ã–∑–≤–∞–Ω
üìÅ –§–∞–π–ª –ª–æ–≥–æ—Ç–∏–ø–∞: File {name: 'img_calc.png', size: 1267977}
‚úÖ –û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏: {...}
üñºÔ∏è –õ–æ–≥–æ—Ç–∏–ø –≤ –æ—Ç–≤–µ—Ç–µ —Å–µ—Ä–≤–µ—Ä–∞: http://localhost:8000/rails/active_storage/blobs/redirect/...
üîÑ –û–±–Ω–æ–≤–ª—è–µ–º preview –ª–æ–≥–æ—Ç–∏–ø–∞ –Ω–∞: http://localhost:8000/rails/active_storage/blobs/redirect/...
```

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

‚úÖ **–ü–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ª–æ–≥–æ—Ç–∏–ø–æ–≤:**
1. –§–∞–π–ª—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ Active Storage
2. –ë—ç–∫–µ–Ω–¥ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ URL –ª–æ–≥–æ—Ç–∏–ø–æ–≤
3. –§—Ä–æ–Ω—Ç–µ–Ω–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
4. –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –æ—Ç–¥–∞–µ—Ç—Å—è Active Storage –ª–æ–≥–æ—Ç–∏–ø–∞–º –Ω–∞–¥ —Å—Ç–∞—Ä—ã–º–∏ URL

‚úÖ **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤: –º–∞–∫—Å–∏–º—É–º 5MB, —Ñ–æ—Ä–º–∞—Ç—ã JPEG/PNG/GIF/WebP
- FormData API –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ —Ñ–∞–π–ª–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏
- –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ `logo_url`

‚úÖ **UX —É–ª—É—á—à–µ–Ω–∏—è:**
- –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ preview –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
- –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
- Graceful fallback –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –ª–æ–≥–æ—Ç–∏–ø–æ–≤

## üìÅ –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### Backend (tire-service-master-api)
- ‚úÖ –ú–æ–¥–µ–ª—å Partner —Å Active Storage (—É–∂–µ –±—ã–ª–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞)
- ‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä PartnersController —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π —Ñ–∞–π–ª–æ–≤ (—É–∂–µ –±—ã–ª —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω)

### Frontend (tire-service-master-web)
- ‚úÖ `src/types/models.ts` - –¥–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `logo` –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Partner
- ‚úÖ `src/pages/partners/PartnerFormPage.tsx` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ preview –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
- ‚úÖ `src/pages/partners/PartnerFormPage.tsx` - –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç Active Storage –ª–æ–≥–æ—Ç–∏–ø–æ–≤

## üöÄ –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É
–ó–∞–≥—Ä—É–∑–∫–∞ –ª–æ–≥–æ—Ç–∏–ø–æ–≤ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ.

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 1 –∏—é–ª—è 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–ï–®–ï–ù–û 