<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ "–æ—Ç–∫–ª–æ–Ω–µ–Ω" –¥–ª—è –æ—Ç–∑—ã–≤–æ–≤</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background-color: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        .warning { background-color: #fff3cd; border-color: #ffeaa7; }
        .info { background-color: #d1ecf1; border-color: #bee5eb; }
        
        button { margin: 5px; padding: 10px 15px; cursor: pointer; border: none; border-radius: 4px; font-weight: bold; }
        .btn-primary { background-color: #007bff; color: white; }
        .btn-success { background-color: #28a745; color: white; }
        .btn-warning { background-color: #ffc107; color: black; }
        .btn-danger { background-color: #dc3545; color: white; }
        .btn-info { background-color: #17a2b8; color: white; }
        
        pre { background-color: #f8f9fa; padding: 10px; border-radius: 3px; overflow-x: auto; font-size: 12px; }
        
        .status-indicator { 
            display: inline-block; 
            padding: 4px 12px; 
            border-radius: 4px; 
            font-size: 12px; 
            font-weight: bold; 
            margin: 2px;
        }
        .status-published { background-color: #28a745; color: white; }
        .status-pending { background-color: #ffc107; color: black; }
        .status-rejected { background-color: #dc3545; color: white; }
        
        .review-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            background: #f9f9f9;
        }
        
        .review-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .rating {
            color: #ffc107;
            font-size: 18px;
        }
        
        h1 { color: #333; text-align: center; }
        h2 { color: #555; border-bottom: 2px solid #007bff; padding-bottom: 10px; }
        h3 { color: #666; }
        
        .test-results {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .test-item {
            padding: 8px;
            margin: 5px 0;
            border-radius: 4px;
        }
        
        .test-pass { background-color: #d4edda; color: #155724; }
        .test-fail { background-color: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ "–æ—Ç–∫–ª–æ–Ω–µ–Ω" –¥–ª—è –æ—Ç–∑—ã–≤–æ–≤</h1>
        
        <div class="test-section info">
            <h3>üìã –¶–µ–ª—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</h3>
            <p>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å —Å—Ç–∞—Ç—É—Å –æ—Ç–∑—ã–≤–∞ "–æ—Ç–∫–ª–æ–Ω–µ–Ω" (rejected) –∏ —á—Ç–æ —ç—Ç–æ—Ç —Å—Ç–∞—Ç—É—Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è.</p>
            
            <h4>üéØ –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:</h4>
            <ul>
                <li>1. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</li>
                <li>2. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö –æ—Ç–∑—ã–≤–æ–≤</li>
                <li>3. –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –æ—Ç–∑—ã–≤–∞ –Ω–∞ "rejected"</li>
                <li>4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ —Å—Ç–∞—Ç—É—Å—É "rejected"</li>
                <li>5. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö —Å—Ç–∞—Ç—É—Å–æ–≤</li>
            </ul>
        </div>

        <div class="test-section">
            <h2>üîê 1. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h2>
            <button class="btn-primary" onclick="testLogin()">–í–æ–π—Ç–∏ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</button>
            <div id="loginResult"></div>
        </div>

        <div class="test-section">
            <h2>üìù 2. –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –æ—Ç–∑—ã–≤–æ–≤</h2>
            <button class="btn-info" onclick="getAllReviews()">–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –æ—Ç–∑—ã–≤—ã</button>
            <div id="allReviewsResult"></div>
        </div>

        <div class="test-section">
            <h2>‚ùå 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ "rejected"</h2>
            <p>–í—ã–±–µ—Ä–∏—Ç–µ –æ—Ç–∑—ã–≤ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞:</p>
            <select id="reviewSelect" style="padding: 8px; margin: 10px 0; width: 200px;">
                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –æ—Ç–∑—ã–≤...</option>
            </select>
            <br>
            <button class="btn-danger" onclick="setRejectedStatus()">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å "–û—Ç–∫–ª–æ–Ω–µ–Ω"</button>
            <div id="rejectedResult"></div>
        </div>

        <div class="test-section">
            <h2>üîç 4. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º</h2>
            <button class="btn-success" onclick="getReviewsByStatus('published')">–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–µ</button>
            <button class="btn-warning" onclick="getReviewsByStatus('pending')">–ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏</button>
            <button class="btn-danger" onclick="getReviewsByStatus('rejected')">–û—Ç–∫–ª–æ–Ω–µ–Ω–Ω—ã–µ</button>
            <div id="filterResult"></div>
        </div>

        <div class="test-section">
            <h2>üîÑ 5. –¢–µ—Å—Ç —Å–º–µ–Ω—ã –≤—Å–µ—Ö —Å—Ç–∞—Ç—É—Å–æ–≤</h2>
            <button class="btn-info" onclick="testAllStatusChanges()">–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Å—Ç–∞—Ç—É—Å—ã</button>
            <div id="statusTestResult"></div>
        </div>

        <div class="test-results">
            <h2>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</h2>
            <div id="testSummary"></div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:8000/api/v1';
        let authToken = '';
        let testResults = [];

        function addTestResult(testName, passed, details) {
            testResults.push({ testName, passed, details });
            updateTestSummary();
        }

        function updateTestSummary() {
            const summaryDiv = document.getElementById('testSummary');
            const passedTests = testResults.filter(t => t.passed).length;
            const totalTests = testResults.length;
            
            let html = `<h3>–ü—Ä–æ–π–¥–µ–Ω–æ —Ç–µ—Å—Ç–æ–≤: ${passedTests}/${totalTests}</h3>`;
            
            testResults.forEach(test => {
                const className = test.passed ? 'test-pass' : 'test-fail';
                const icon = test.passed ? '‚úÖ' : '‚ùå';
                html += `<div class="test-item ${className}">${icon} ${test.testName}: ${test.details}</div>`;
            });
            
            summaryDiv.innerHTML = html;
        }

        async function testLogin() {
            const resultDiv = document.getElementById('loginResult');
            resultDiv.innerHTML = '<p>üîÑ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è...</p>';
            
            try {
                const response = await fetch(`${API_BASE}/auth/login`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        auth: {
                            login: 'admin@test.com',
                            password: 'admin123'
                        }
                    })
                });

                if (response.ok) {
                    const data = await response.json();
                    authToken = data.access_token;
                    
                    resultDiv.innerHTML = `
                        <div class="success">
                            <h4>‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞</h4>
                            <p><strong>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:</strong> ${data.user.email}</p>
                            <p><strong>–†–æ–ª—å:</strong> ${data.user.role}</p>
                            <p><strong>–¢–æ–∫–µ–Ω –ø–æ–ª—É—á–µ–Ω:</strong> ${authToken ? '–î–∞' : '–ù–µ—Ç'}</p>
                        </div>
                    `;
                    addTestResult('–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞', true, `–£—Å–ø–µ—à–Ω–æ –≤–æ—à–ª–∏ –∫–∞–∫ ${data.user.email}`);
                } else {
                    throw new Error(`HTTP ${response.status}`);
                }
            } catch (error) {
                resultDiv.innerHTML = `<div class="error"><h4>‚ùå –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏</h4><p>${error.message}</p></div>`;
                addTestResult('–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞', false, error.message);
            }
        }

        async function getAllReviews() {
            const resultDiv = document.getElementById('allReviewsResult');
            resultDiv.innerHTML = '<p>üîÑ –ó–∞–≥—Ä—É–∑–∫–∞ –æ—Ç–∑—ã–≤–æ–≤...</p>';
            
            try {
                const response = await fetch(`${API_BASE}/reviews`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    }
                });

                if (response.ok) {
                    const reviews = await response.json();
                    
                    // –ó–∞–ø–æ–ª–Ω—è–µ–º —Å–µ–ª–µ–∫—Ç –¥–ª—è –≤—ã–±–æ—Ä–∞ –æ—Ç–∑—ã–≤–∞
                    const reviewSelect = document.getElementById('reviewSelect');
                    reviewSelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –æ—Ç–∑—ã–≤...</option>';
                    
                    let html = `<div class="success"><h4>‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ –æ—Ç–∑—ã–≤–æ–≤: ${reviews.length}</h4>`;
                    
                    // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º
                    const byStatus = {
                        published: reviews.filter(r => r.status === 'published'),
                        pending: reviews.filter(r => r.status === 'pending'),
                        rejected: reviews.filter(r => r.status === 'rejected')
                    };
                    
                    html += `
                        <p>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º:</p>
                        <ul>
                            <li>–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã—Ö: <span class="status-indicator status-published">${byStatus.published.length}</span></li>
                            <li>–ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏: <span class="status-indicator status-pending">${byStatus.pending.length}</span></li>
                            <li>–û—Ç–∫–ª–æ–Ω–µ–Ω–Ω—ã—Ö: <span class="status-indicator status-rejected">${byStatus.rejected.length}</span></li>
                        </ul>
                    `;
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ 5 –æ—Ç–∑—ã–≤–æ–≤
                    html += '<h4>üìù –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ—Ç–∑—ã–≤—ã:</h4>';
                    reviews.slice(0, 5).forEach(review => {
                        const statusClass = `status-${review.status}`;
                        const stars = '‚òÖ'.repeat(review.rating) + '‚òÜ'.repeat(5 - review.rating);
                        
                        html += `
                            <div class="review-card">
                                <div class="review-header">
                                    <span class="rating">${stars}</span>
                                    <span class="status-indicator ${statusClass}">${getStatusLabel(review.status)}</span>
                                </div>
                                <p><strong>ID:</strong> ${review.id}</p>
                                <p><strong>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</strong> ${review.comment || '–ë–µ–∑ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è'}</p>
                                <p><strong>–ö–ª–∏–µ–Ω—Ç:</strong> ${review.client?.user?.email || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</p>
                            </div>
                        `;
                        
                        // –î–æ–±–∞–≤–ª—è–µ–º –≤ —Å–µ–ª–µ–∫—Ç
                        reviewSelect.innerHTML += `<option value="${review.id}">ID: ${review.id} - ${review.status} - ${review.rating}‚òÖ</option>`;
                    });
                    
                    html += '</div>';
                    resultDiv.innerHTML = html;
                    addTestResult('–ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –æ—Ç–∑—ã–≤–æ–≤', true, `–ó–∞–≥—Ä—É–∂–µ–Ω–æ ${reviews.length} –æ—Ç–∑—ã–≤–æ–≤`);
                } else {
                    throw new Error(`HTTP ${response.status}`);
                }
            } catch (error) {
                resultDiv.innerHTML = `<div class="error"><h4>‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –æ—Ç–∑—ã–≤–æ–≤</h4><p>${error.message}</p></div>`;
                addTestResult('–ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –æ—Ç–∑—ã–≤–æ–≤', false, error.message);
            }
        }

        async function setRejectedStatus() {
            const reviewSelect = document.getElementById('reviewSelect');
            const reviewId = reviewSelect.value;
            const resultDiv = document.getElementById('rejectedResult');
            
            if (!reviewId) {
                resultDiv.innerHTML = '<div class="warning"><p>‚ö†Ô∏è –í—ã–±–µ—Ä–∏—Ç–µ –æ—Ç–∑—ã–≤ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞</p></div>';
                return;
            }
            
            resultDiv.innerHTML = '<p>üîÑ –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ "rejected"...</p>';
            
            try {
                const response = await fetch(`${API_BASE}/reviews/${reviewId}`, {
                    method: 'PATCH',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        review: {
                            status: 'rejected'
                        }
                    })
                });

                if (response.ok) {
                    const updatedReview = await response.json();
                    
                    resultDiv.innerHTML = `
                        <div class="success">
                            <h4>‚úÖ –°—Ç–∞—Ç—É—Å —É—Å–ø–µ—à–Ω–æ –∏–∑–º–µ–Ω–µ–Ω</h4>
                            <p><strong>ID –æ—Ç–∑—ã–≤–∞:</strong> ${updatedReview.id}</p>
                            <p><strong>–ù–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å:</strong> <span class="status-indicator status-${updatedReview.status}">${getStatusLabel(updatedReview.status)}</span></p>
                            <p><strong>is_published:</strong> ${updatedReview.is_published}</p>
                            <p><strong>–†–µ–π—Ç–∏–Ω–≥:</strong> ${'‚òÖ'.repeat(updatedReview.rating)}</p>
                        </div>
                    `;
                    addTestResult('–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ "rejected"', true, `–û—Ç–∑—ã–≤ ID:${reviewId} –ø–µ—Ä–µ–≤–µ–¥–µ–Ω –≤ —Å—Ç–∞—Ç—É—Å "rejected"`);
                } else {
                    const errorData = await response.json();
                    throw new Error(`HTTP ${response.status}: ${JSON.stringify(errorData)}`);
                }
            } catch (error) {
                resultDiv.innerHTML = `<div class="error"><h4>‚ùå –û—à–∏–±–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞</h4><p>${error.message}</p></div>`;
                addTestResult('–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ "rejected"', false, error.message);
            }
        }

        async function getReviewsByStatus(status) {
            const resultDiv = document.getElementById('filterResult');
            resultDiv.innerHTML = `<p>üîÑ –ó–∞–≥—Ä—É–∑–∫–∞ –æ—Ç–∑—ã–≤–æ–≤ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "${status}"...</p>`;
            
            try {
                const response = await fetch(`${API_BASE}/reviews?status=${status}`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    }
                });

                if (response.ok) {
                    const reviews = await response.json();
                    const statusClass = `status-${status}`;
                    
                    let html = `
                        <div class="success">
                            <h4>‚úÖ –û—Ç–∑—ã–≤—ã —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º <span class="status-indicator ${statusClass}">${getStatusLabel(status)}</span></h4>
                            <p><strong>–ù–∞–π–¥–µ–Ω–æ:</strong> ${reviews.length} –æ—Ç–∑—ã–≤–æ–≤</p>
                    `;
                    
                    if (reviews.length > 0) {
                        html += '<h5>üìã –°–ø–∏—Å–æ–∫ –æ—Ç–∑—ã–≤–æ–≤:</h5>';
                        reviews.forEach(review => {
                            const stars = '‚òÖ'.repeat(review.rating) + '‚òÜ'.repeat(5 - review.rating);
                            html += `
                                <div class="review-card">
                                    <p><strong>ID:</strong> ${review.id} | <strong>–†–µ–π—Ç–∏–Ω–≥:</strong> ${stars} | <strong>–°—Ç–∞—Ç—É—Å:</strong> <span class="status-indicator ${statusClass}">${review.status}</span></p>
                                    <p><strong>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</strong> ${review.comment || '–ë–µ–∑ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è'}</p>
                                </div>
                            `;
                        });
                    }
                    
                    html += '</div>';
                    resultDiv.innerHTML = html;
                    addTestResult(`–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å—Ç–∞—Ç—É—Å—É "${status}"`, true, `–ù–∞–π–¥–µ–Ω–æ ${reviews.length} –æ—Ç–∑—ã–≤–æ–≤`);
                } else {
                    throw new Error(`HTTP ${response.status}`);
                }
            } catch (error) {
                resultDiv.innerHTML = `<div class="error"><h4>‚ùå –û—à–∏–±–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏</h4><p>${error.message}</p></div>`;
                addTestResult(`–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å—Ç–∞—Ç—É—Å—É "${status}"`, false, error.message);
            }
        }

        async function testAllStatusChanges() {
            const resultDiv = document.getElementById('statusTestResult');
            const reviewSelect = document.getElementById('reviewSelect');
            const reviewId = reviewSelect.value;
            
            if (!reviewId) {
                resultDiv.innerHTML = '<div class="warning"><p>‚ö†Ô∏è –í—ã–±–µ—Ä–∏—Ç–µ –æ—Ç–∑—ã–≤ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</p></div>';
                return;
            }
            
            resultDiv.innerHTML = '<p>üîÑ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Å—Ç–∞—Ç—É—Å–æ–≤...</p>';
            
            const statuses = ['pending', 'published', 'rejected'];
            let html = '<div class="info"><h4>üîÑ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–º–µ–Ω—ã —Å—Ç–∞—Ç—É—Å–æ–≤:</h4>';
            
            for (const status of statuses) {
                try {
                    const response = await fetch(`${API_BASE}/reviews/${reviewId}`, {
                        method: 'PATCH',
                        headers: {
                            'Authorization': `Bearer ${authToken}`,
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            review: { status: status }
                        })
                    });

                    if (response.ok) {
                        const updatedReview = await response.json();
                        const statusClass = `status-${status}`;
                        html += `<p>‚úÖ ${getStatusLabel(status)}: <span class="status-indicator ${statusClass}">${updatedReview.status}</span> (is_published: ${updatedReview.is_published})</p>`;
                    } else {
                        html += `<p>‚ùå ${getStatusLabel(status)}: –û—à–∏–±–∫–∞ HTTP ${response.status}</p>`;
                    }
                } catch (error) {
                    html += `<p>‚ùå ${getStatusLabel(status)}: ${error.message}</p>`;
                }
                
                // –ù–µ–±–æ–ª—å—à–∞—è –ø–∞—É–∑–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
                await new Promise(resolve => setTimeout(resolve, 500));
            }
            
            html += '</div>';
            resultDiv.innerHTML = html;
            addTestResult('–¢–µ—Å—Ç –≤—Å–µ—Ö —Å—Ç–∞—Ç—É—Å–æ–≤', true, `–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤—Å–µ —Å—Ç–∞—Ç—É—Å—ã –¥–ª—è –æ—Ç–∑—ã–≤–∞ ID:${reviewId}`);
        }

        function getStatusLabel(status) {
            const labels = {
                'published': '–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω',
                'pending': '–ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏',
                'rejected': '–û—Ç–∫–ª–æ–Ω–µ–Ω'
            };
            return labels[status] || status;
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –±–∞–∑–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤
        window.onload = function() {
            setTimeout(() => {
                testLogin();
                setTimeout(() => {
                    getAllReviews();
                }, 2000);
            }, 1000);
        };
    </script>
</body>
</html> 